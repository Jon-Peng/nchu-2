<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
>
<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <link rel="icon" href="/images/paperPlane.gif">
    <title>NCHU</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/css/index.css">
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js" type="application/javascript"></script>
</head>


<body class="body" id="body" style="background-image: url('https://api.sanv.org/api/bingtodayimg/timthumb.php?src=https://api.sanv.org/api/bingtodayimg/savebingimg_cn/2020_01_16.jpg&h=900&w=1400&zc=1')">
<script>
    var nowDate = new Date().getFullYear() + '_' + new Date().getMonth()+1 + '_' + new Date().getDate();
    console.log(nowDate);
    document.getElementById("body").style="background-image: url('https://api.sanv.org/api/bingtodayimg/timthumb.php?src=https://api.sanv.org/api/bingtodayimg/savebingimg_cn/"+
            nowDate + ".jpg&h=900&w=1400&zc=1')"
</script>
<!--导航栏-->
<nav class="navbar navbar-default navbar-fixed-top" th:include="nav::navPart">
</nav>
<!--<div id="bg-over">
</div>-->
<!--content-->
<div class="container-fluid content">
    <div class="row">
        <div class="col-xs-12 col-md-9" style="background: rgba(255,255,255,0.95);border-radius: 3px;">
            <ul class="nav nav-tabs">
                <li role="presentation" class="active">
                    <a th:href="@{/}">
                        Home
                    </a>
                </li>
                <li role="presentation">
                    <a th:href="@{/post/toPublish}">
                        发帖
                    </a>
                </li>
                <li role="presentation"><a href="#">Messages</a></li>
            </ul>
            <!--帖子展示-->

            <div class="media" th:each="postUserEntry : ${session.postUserMap}">
                <div class="media-left">
                    <a href="#">
                        <img style="width: 40px; box-shadow: 1px 1px 2px midnightblue; " class="media-object img-circle"
                             th:src="${postUserEntry.value.avatar}"
                             th:alt="${postUserEntry.value.name}">
                    </a>
                </div>
                <div class="media-body">
                    <h4 class="media-heading text-primary" style="font-family:'楷体'" th:text="${postUserEntry.value.nickName}"></h4>
                    <span class="text-justify" th:text="${postUserEntry.key.title}"></span> <!--标题-->
                    <a th:href="@{'/post/'+${postUserEntry.key.postId}}"><span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a><!--图标-->
                    <br>
                    <span class="text-muted">
                            <span th:text="${postUserEntry.key.readCount}"></span> 阅读 ·
                            <span th:text="${postUserEntry.key.commentCount}"></span> 评论 ·
                            <span th:text="${#dates.format(postUserEntry.key.createTime,'MM-dd HH:mm')}"></span>
                        </span>
                </div>
                <hr style="width: 710px">
            </div>

            <nav aria-label="Page navigation">
                <ul class="pagination">

                    <li th:if="${session.pageInfo.hasPreviousPage}">
                        <a th:href="'?page=1'">首页</a>
                    </li>
                    <li>
                        <a href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li th:if="${session.pageInfo.hasPreviousPage}">
                        <a th:href="@{(page=${session.pageInfo.pageNum}-1)}">上一页</a>
                    </li>
                    <li th:if="${session.pageInfo.pageNum}>2">
                        <a th:href="@{/(page=${session.pageInfo.pageNum}-2)}"><span th:text="${session.pageInfo.pageNum}-2"></span></a>
                    </li>
                    <li th:if="${session.pageInfo.pageNum}>1">
                        <a th:href="@{/(page=${session.pageInfo.pageNum}-1)}"><span th:text="${session.pageInfo.pageNum}-1"></span></a>
                    </li>
                    <!--当前页-->
                    <li class="active disabled">
                        <a href="#"><span th:text="${session.pageInfo.pageNum}"></span></a>
                    </li>
                    <li th:if="${session.pageInfo.pageNum}+1<=${session.pageInfo.pages}">
                        <a th:href="@{/(page=${session.pageInfo.pageNum}+1)}"><span th:text="${session.pageInfo.pageNum}+1"></span></a>
                    </li>
                    <li th:if="${session.pageInfo.pageNum}+2<=${session.pageInfo.pages}">
                        <a th:href="@{/(page=${session.pageInfo.pageNum}+2)}"><span th:text="${session.pageInfo.pageNum}+2"></span></a>
                    </li>
                    <li th:if="${session.pageInfo.hasNextPage}">
                        <a th:href="@{/(page=${session.pageInfo.pageNum}+1)}">下一页</a>
                    </li>
                    <li th:if="${session.pageInfo.hasNextPage}">
                        <a th:href="@{/(page=${session.pageInfo.pageNum}+1)}" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>

        </div>
        <div class="col-md-3" style="background: rgba(255,255,255,0.85); margin-left: 10px; width: 300px; border-radius: 3px;">
            <h2>( ⓛ ω ⓛ *)</h2>
            <h3>这位同学你已存活<span id="liveDays" th:text="${session.liveDays}"></span>天</h3>
            <!--古诗-->
            <hr>
            <div>
                <h4 id="gushiContent">1</h4>
                ---《<span id="gushiName"></span>》
                <span id="gushiAuthor">2</span>
                <script>
                    var xhr = new XMLHttpRequest();
                    xhr.open('get', 'https://v1.jinrishici.com/all.json');
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4) {
                            var data = JSON.parse(xhr.responseText);
                            var gushici = document.getElementById('gushiContent');
                            gushici.innerHTML = data.content;
                            var gushiAuthor = document.getElementById('gushiAuthor');
                            gushiAuthor.innerHTML = data.author;
                            var gushiAuthor = document.getElementById('gushiName');
                            gushiAuthor.innerHTML = data.origin;
                        }
                    };
                    xhr.send()
                </script>
            </div>
            <div>
                <p id="todayInHistory">
                    3
                </p>
                <script>
                    var xhr2 = new XMLHttpRequest();
                    xhr2.open('get', 'http://www.jiahengfei.cn:33550/port/history?dispose=detail&key=jiahengfei&month=1&day=16');
                    xhr2.onreadystatechange = function () {
                        if (xhr2.readyState === 4) {
                            var data = JSON.parse(xhr2.responseText);
                            var str = "";
                            for (var onePiece in data.data){
                                str += "<tr>"+ onePiece.year +"</tr>" +
                                       "<tr>"+ onePiece.title +"</tr>"
                            }
                            var todayInHistory = document.getElementById('todayInHistory');
                            todayInHistory.innerHTML = str;
                        }
                    };
                    xhr2.send()
                </script>
                <script >
                    function dosomething(jondata) {
                        console.log(jondata)
                    }
                </script>
                <script src="http://www.jiahengfei.cn:33550/port/history?dispose=detail&key=jiahengfei&month=1&day=16&callback=dosomething"></script>
            </div>
        </div>

    </div>
</div>

<script th:inline="javascript">
    function changeMusic() {
        var a = document.getElementById('changeMusic');
        a.src = 'https://api.uomg.com/api/rand.music';
    }
</script>
</body>
</html>